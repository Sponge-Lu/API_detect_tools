# API Hub Management Tools

一个基于all-api-hub(https://github.com/qixing-jk/all-api-hub) 开发的用于API管理与监控的桌面客户端，能自动从浏览器获取认证信息，通过API端点获取余额/模型等信息。

## 核心功能

- **自动认证**：通过连接Chrome调试实例，自动获取并使用Cookie进行API请求。
- **智能登录等待** 🆕：刷新时检测到未登录状态会自动等待用户登录（最长10分钟），而不是直接关闭浏览器。同时支持 API 回退检测，即使 localStorage 中没有数据也能识别已登录状态。
- **浏览器关闭检测** 🆕：当用户手动关闭浏览器时，自动检测并取消所有正在进行的操作（等待登录、等待Cloudflare验证等），避免资源浪费。浏览器关闭后可以自动重新启动，不影响后续操作。
- **站点添加模式** 🆕：新增“智能添加站点（默认）”和“手动添加站点”两种模式，前者通过浏览器自动获取认证信息，后者支持直接填写站点URL、用户ID和Access Token。
- **多站点管理**：集中管理和检测多个API站点，支持拖拽排序。
- **自定义站点名称** 🆕：支持修改站点显示名称，重启应用后名称会正确保留，不会被覆盖。
- **智能检测**：自动发现站点支持的模型列表，优先使用定价数据获取完整模型列表（1000+个模型）。
- **状态查询**：快速查询账户余额和今日消费。
- **灵活检测**：支持并发或串行模式对多个站点进行检测。
- **完整兼容**：支持 New API、One API、One Hub、Done Hub、Veloera、VoAPI、Super-API 等7种站点类型。
- **用户分组**：支持查看和筛选不同用户分组的API Keys和模型，自动应用分组倍率计算价格。
- **模型定价**：
  - 智能显示计费模式：按量计费（$/1M tokens）、按次计费（$/次）
  - 自动格式化价格：去除多余的0（如 200.0000 → $200，0.001 → $0.001）
  - 分组倍率支持：根据用户分组动态计算模型价格
  - 多站点兼容：正确处理 New API 和 Done Hub/One Hub 的不同价格体系
- **签到功能**：
  - 智能检测站点是否支持签到（尊重站点配置）
  - 自动获取签到状态（可签到/已签到）
  - 一键签到并显示奖励
  - 签到失败时智能引导用户手动签到
  - 支持用户手动启用/禁用签到功能
  - 支持浏览器模式绕过Cloudflare验证
- **加油站功能**：
  - 支持为每个站点配置额外链接（抽奖、额外签到等）
  - 一级面板显示快捷跳转按钮
  - 适配没有签到但有其他福利活动的站点
- **主题系统** 🆕：
  - 白天模式：清爽明亮的浅色设计，翡翠绿主题色
  - 夜晚模式：优雅舒适的深色设计
  - 跟随系统：根据操作系统设置自动切换主题
  - 主题记忆：自动保存用户偏好设置
- **现代化 UI 设计** 🆕：
  - 清爽明亮的配色系统（翡翠绿 + 珊瑚橙）
  - 动态 Logo：黑色六边形 + 粒子动画效果
  - 高对比度设计：优化可读性和视觉层次
  - 装饰背景：低透明度渐变球体，增加视觉深度
- **界面优化**：
  - 紧凑模式：优化卡片高度，800x800窗口显示更多内容
  - 多展开支持：可同时展开多个站点查看详情
  - 拖拽排序：通过拖拽调整站点显示顺序
  - 自定义名称：支持修改站点显示名称（不会被覆盖）
  - 信息密度提升：优化间距，在相同空间显示更多信息
- **性能优化**：
  - Chrome 启动优化：使用 spawn 替代 exec，更稳定可靠
  - 智能路径检测：自动搜索多个可能的 Chrome 安装位置
  - 浏览器进程管理：彻底清理旧进程，避免端口占用
  - 配置保存优化：确保所有修改完整保存，防止数据丢失
  - 智能端口检测：自动等待调试端口就绪
  - **并发检测优化** 🆕：引用计数机制确保并发检测时浏览器不会被过早关闭，所有站点共享浏览器实例以保持登录状态
  - **多 Tab 并发检测** 🆕：在同一个 Chrome 窗口中为每个站点创建独立标签页，避免并发检测时多个站点抢占同一个页面导致互相干扰
  - **登录检测增强** 🆕：智能检测登录状态，优先检查 localStorage，同时定期尝试 API 回退，确保已登录用户能被正确识别
  - **浏览器关闭检测** 🆕：监听浏览器断开事件，自动取消正在进行的操作，支持浏览器关闭后自动重新启动，确保浏览器复用功能正常工作
- **数据持久化**：检测数据自动缓存，启动时立即显示。
- **错误码与超时提示** 🆕：对 400/403/500/502/503/504/522 等致命 HTTP 状态码以及请求超时立即终止当前站点检测，前端保留上次成功的检测数据，并在更新时间后显示 `Error Code: xxx` 或 `Timeout Ns`，下次启动应用时也会恢复上次检测的状态和错误信息。

## 技术栈

- **框架**: Electron + React + TypeScript
- **UI**: Tailwind CSS
- **浏览器自动化**: Puppeteer

## 快速开始

1. 直接使用安装包 https://github.com/Sponge-Lu/API_detect_tools/releases
或者
2. 开发环境构建应用：
  1.  **安装依赖**
      ```bash
      npm install
      ```
  2.  **启动开发环境**
      ```bash
      npm run dev
      ```
  3.  **构建应用**
      ```bash
      npm run dist
      ```

## 许可证

MIT