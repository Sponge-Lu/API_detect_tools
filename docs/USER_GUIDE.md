# API Hub Management Tools - 用户使用指南

## 📖 目录

- [简介](#简介)
- [核心功能](#核心功能)
  - [多站点管理](#多站点管理)
  - [自动认证与登录](#自动认证与登录)
  - [API Key 管理](#api-key-管理)
  - [模型定价与查询](#模型定价与查询)
  - [签到与福利](#签到与福利)
  - [Token 统计](#token-统计)
  - [数据备份与恢复](#数据备份与恢复)
- [WebDAV 云端备份](#webdav-云端备份)
- [使用场景](#使用场景)
- [常见问题 (FAQ)](#常见问题-faq)

---

## 简介

**API Hub Management Tools** 是一个基于 One API 系列项目的桌面管理客户端。它专为管理和监控多个 API 中转站而设计，提供了从自动认证、余额监控到 API Key 管理的一站式解决方案。

支持的站点类型包括：
- One API (原始项目)
- New API (增强版)
- One Hub / Done Hub (分支版本)
- Veloera (定制版)
- VoAPI / Super-API (高性能版)

---

## 核心功能

### 多站点管理

- **集中管理**：在一个界面中添加和管理无限数量的 API 站点。
- **分组功能**：支持自定义站点分组（如"主力站"、"备用站"、"测试站"）。
  - 拖拽站点卡片到分组标签可快速更改分组。
  - 支持分组排序和筛选。
- **自定义名称**：可以为每个站点设置别名，方便识别。
- **拖拽排序**：通过拖拽自由调整站点在列表中的顺序。

### 自动认证与登录

- **智能添加模式**：
  - 只需输入站点 URL，软件会自动启动内置浏览器。
  - 在浏览器中登录账号后，软件自动捕获认证信息（Cookie/Token）。
  - 无需手动查找 Access Token 或 User ID。
- **手动添加模式**：
  - 针对高级用户，支持直接填写 URL、User ID 和 Access Token。
- **Cloudflare 绕过**：
  - 内置 Cloudflare 验证等待机制，自动处理人机验证页面。
- **智能登录保持**：
  - 自动检测 Session 过期，并在后台尝试刷新或提示重新登录。
- **批量检测登录提醒**：
  - 批量检测时如发现站点未登录，会自动打开浏览器并弹窗提示，等待用户完成登录后再继续获取数据。

### 批量检测体验

- **即时更新**：批量检测时，单个站点完成就立即在列表中更新结果，无需等全部结束。
- **并发可调**：设置中可开启/关闭并发并设置最大并发数（默认 3，1–5 可调），根据机器和网络情况权衡速度与稳定性。
- **超时默认 30s**：超时可在设置中调整，默认 30 秒，适配多数站点的响应时间。
- **浏览器更安全**：调试端口随机化、取消隐藏/后台启动，降低端口冲突和杀软误报概率。

### API Key 管理

- **可视化管理**：在桌面端直接查看、创建、删除 API Key。
- **创建令牌**：
  - 支持设置令牌名称、分组、过期时间和额度限制。
  - 自动适配不同站点类型的创建协议。
- **浏览器模式回退**：
  - 当 API 端口被防火墙拦截时，自动切换到浏览器模式完成操作。

### 模型定价与查询

- **智能定价展示**：
  - 自动区分按量计费（$/1M tokens）和按次计费（$/次）。
  - 根据用户分组自动计算最终价格（包含倍率）。
- **模型列表**：
  - 优先展示站点实际支持的完整模型列表（1000+ 模型）。
  - 支持筛选和搜索模型。
- **全局搜索**
  - 根据关键字全部搜索并显示站点，隐藏没有关键字的站点

### 签到与福利

- **自动签到检测**：
  - 智能识别站点是否支持签到功能。
  - 显示签到状态（可签到/已签到）。
- **一键签到**：
  - 点击按钮即可完成签到并显示获得的奖励金额。
  - 支持浏览器模式绕过 Cloudflare 完成签到。
- **加油站功能**：
  - 支持配置额外的福利链接（如抽奖页面），提供快捷跳转入口。

### Token 统计

- **用量监控**：
  - 实时显示今日 Token 使用量（输入/输出/总量）。
  - 统计今日请求次数。
- **速率监控**：
  - 自动计算 RPM（每分钟请求数）和 TPM（每分钟 Token 数）。

### 数据备份与恢复

- **自动备份**：
  - 配置文件自动备份到用户主目录 `~/.api-hub-management-tools/`。
  - 卸载应用不会丢失配置。
- **一键恢复**：
  - 提供可视化的备份选择对话框，可随时恢复到任意历史状态。
  - 恢复后立即刷新数据，无需重启应用。

### WebDAV 云端备份

- **云端同步**：
  - 支持将配置备份到 WebDAV 云存储服务（如坚果云、NextCloud、Synology NAS）。
  - 实现跨设备配置同步和云端数据保护。
- **配置方式**：
  - 在设置面板中启用 WebDAV 备份功能。
  - 填写服务器地址、用户名、应用密码和远程路径。
  - 点击"测试连接"验证配置是否正确。
- **备份管理**：
  - 点击"管理云端备份"打开备份管理对话框。
  - 支持上传新备份、查看备份列表、恢复和删除备份。
  - 备份文件自动按时间戳命名，格式为 `config_YYYY-MM-DD_HH-mm-ss.json`。
- **自动清理**：
  - 可设置最大备份数量（默认 10 个）。
  - 超过限制时自动删除最旧的备份。

---

## 使用场景

### 1. API 聚合管理
如果你同时使用多个 API 中转站（如为了分散风险或利用不同站点的优势模型），本工具可以帮助你统一监控所有站点的余额和状态，无需分别登录每个网站。

### 2. 开发者调试
开发者可以利用本工具快速创建测试用的 API Key，查看模型定价，以及监控 API 调用速率。

### 3. 福利领取
对于支持每日签到的站点，本工具提供了一键签到功能，帮助你轻松领取每日额度，避免遗漏。

---

## 常见问题 (FAQ)

### Q: 为什么添加站点时浏览器打开了但没有自动关闭？
**A**: 
1. 请确保你已经完成了登录操作。
2. 如果遇到 Cloudflare 验证，请手动完成人机验证。
3. 软件会等待直到成功获取用户信息，如果长时间无反应，请检查网络连接或尝试手动模式。

### Q: “模型接口请求失败：Certificate has expired” 怎么办？
**A**:
1. 站点的 HTTPS 证书可能已过期或不受信任，请联系站点管理员更新证书。
2. 批量检测时遇到证书错误会直接提示，不会长时间超时，可先检测其它站点。
3. 若本地网络拦截导致证书问题，尝试切换网络或在可信网络下再试。

### Q: "API Key 创建失败" 是什么原因？
**A**:
1. 检查你的账号权限，部分站点禁止普通用户创建令牌。
2. 可能是站点开启了严格的防火墙（如 Cloudflare），软件会自动尝试浏览器模式，请留意弹出的浏览器窗口。

### Q: 数据显示不准确或延迟？
**A**:
1. 点击站点卡片右侧的刷新按钮手动更新数据。
2. 检查网络连接是否正常。
3. 如果站点 API 响应缓慢，可能会导致超时，请稍后重试。

### Q: 如何迁移数据到新电脑？
**A**:
1. 在旧电脑上使用"导出配置"功能生成 JSON 文件。
2. 在新电脑上安装软件，使用"导入配置"功能加载文件。
3. 或者直接复制 `~/.api-hub-management-tools/` 目录下的备份文件。
4. 推荐使用 WebDAV 云端备份功能，在新电脑上直接从云端恢复配置。

### Q: WebDAV 备份连接失败怎么办？
**A**:
1. 检查服务器地址是否正确，必须以 `http://` 或 `https://` 开头。
2. 确认用户名和密码正确，建议使用应用专用密码而非账户密码。
3. 检查远程路径是否存在，软件会自动创建不存在的目录。
4. 如果使用坚果云，请在安全设置中生成应用密码。

### Q: WebDAV 配置保存后丢失了怎么办？
**A**:
1. 此问题已在 v2.1.2 版本修复。
2. 如果仍遇到问题，请确保使用最新版本。
3. WebDAV 配置现在会在其他操作（如拖拽站点排序）时自动保留。

### Q: 支持哪些操作系统？
**A**:
目前支持 Windows 和 macOS。Linux 版本理论上支持但未经充分测试。
